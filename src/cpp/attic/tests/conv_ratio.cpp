#include "partial1D/Density/PiecewiseAffineDensity.h"
#include "partial1D/Density/PiecewiseConstantDensity.h"
#include <partial1D/Solver.h>

// #include <tl/support/string/to_string.h>
// #include <tl/support/operators/argmax.h>
// #include <tl/support/operators/min.h>
// #include <tl/support/operators/abs.h>
// #include <eigen3/Eigen/Dense>
#include <fstream>

using namespace usdot;
using namespace std;

// #include <partial1D/gmp.h>
// using namespace boo<st::multiprecision;
// using TF = number<backends::cpp_bin_float<40>>;
using TF = FP64;


Vec<FP64> inside_boundaries( const Vec<FP64> &bp ) {
    Vec<FP64> lp;
    for( PI n = 1; n + 1 < bp.size(); n += 2 )
        lp << bp[ n ];
    return lp;
}

void glot( TF mi, TF ma, PI nd, auto &&...funcs ) {
    std::ofstream fs( "glot.py" );
    fs << "from matplotlib import pyplot\n";
    auto pf = [&]( auto &&func ) {
        Vec<FP64> xs, ys;
        for( PI n = 0; n <= nd; ++n ) {
            TF x = mi + ( ma - mi ) * n / nd;
            ys << func( x );
            xs << x;
            fs << "pyplot.plot( " << to_string( xs ) << ", " << to_string( ys ) << " )\n";
        }
    };
    ( pf( funcs ), ... );
    fs << "pyplot.show()\n";
}

void glot_barycenters( const Vec<Vec<FP64>> &bp, const Vec<Vec<Vec<FP64>>> &bpi ) {
    const PI beg = bp.size() * 0 / 2;
    const PI end = bp.size() * 2 / 2;

    std::ofstream fs( "glot.py" );
    fs << "from matplotlib import pyplot\n";
    Vec<FP64> ys;
    for( PI nw = beg; nw < end; ++nw )
        ys << ( nw - beg ) / TF( end - beg - 1 );
    for( PI nd = 0; nd < bp[ 0 ].size(); ++nd ) {
        Vec<FP64> xs;
        for( PI nw = beg; nw < end; ++nw )
            xs << bp[ nw ][ nd ];
        fs << "pyplot.plot( " << to_string( xs ) << ", " << to_string( ys ) << " )\n";

        for( PI i = 0; i < bpi.size(); ++i ) {
            const auto &bp = bpi[ i ];
            if ( bp.empty() )
                continue;
            Vec<FP64> xs;
            for( PI nw = beg; nw < end; ++nw )
                xs << bp[ nw ][ nd ];
            Vec<Str> colors{ "red", "blue", "grey", "green", "orange" };
            if ( nd == 0 )
                fs << "pyplot.plot( " << to_string( xs ) << ", " << to_string( ys ) << ", '--', label = '" << i << "', color = '" << colors[ i - 2 ] << "' )\n";
            else
                fs << "pyplot.plot( " << to_string( xs ) << ", " << to_string( ys ) << ", '--', color = '" << colors[ i - 2 ] << "' )\n";
        }
    }
    fs << "pyplot.legend()\n";
    fs << "pyplot.show()\n";
}

// using TF = cpp_bin_float_100;
int main() {
    Vec<TF> di{ -40.027, -39.4886, -39.4281, -39.3739, -39.1929, -38.5699, -38.4969, -38.1295, -38.0116, -37.9852, -37.644, -37.3731, -37.1545, -36.9669, -36.8017, -36.6423, -36.4977, -36.4695, -36.4068, -35.9881, -35.849, -35.6336, -35.6312, -35.5336, -35.4925, -35.4689, -35.3029, -34.9737, -34.7537, -34.7325, -34.542, -34.3329, -34.1408, -34.1098, -33.9281, -33.7736, -33.7548, -33.7074, -33.6811, -33.6688, -33.596, -33.5519, -33.5138, -33.334, -33.2569, -33.1563, -32.9683, -32.8192, -32.7664, -32.691, -32.6443, -32.6153, -32.5776, -32.5639, -32.5086, -32.2873, -32.2725, -32.1765, -31.9964, -31.9675, -31.901, -31.8817, -31.8467, -31.733, -31.6592, -31.6381, -31.6236, -31.5295, -31.4992, -31.4586, -31.4069, -31.3794, -31.302, -31.2236, -31.1087, -30.9692, -30.8448, -30.7474, -30.7181, -30.7091, -30.6276, -30.5459, -30.4577, -30.412, -30.3474, -30.3052, -30.2654, -30.2604, -30.2386, -30.2083, -30.136, -30.1055, -29.8702, -29.8422, -29.8011, -29.7135, -29.6499, -29.61, -29.5951, -29.5034, -29.2929, -29.2821, -29.1971, -29.1484, -29.1422, -29.107, -29.0478, -29.0212, -28.8434, -28.7747, -28.7715, -28.6964, -28.6245, -28.5276, -28.484, -28.4233, -28.3433, -28.3393, -28.3328, -28.3201, -27.9772, -27.8711, -27.8464, -27.8027, -27.7712, -27.686, -27.6807, -27.6724, -27.575, -27.5032, -27.5027, -27.4881, -27.4721, -27.3604, -27.0436, -26.9446, -26.8844, -26.8829, -26.85, -26.788, -26.5749, -26.5155, -26.511, -26.415, -26.4009, -26.3525, -26.3338, -26.3317, -26.3215, -26.3189, -26.2565, -26.235, -26.1659, -25.8765, -25.8224, -25.8059, -25.7775, -25.7408, -25.5449, -25.3655, -25.2705, -25.209, -25.1599, -25.0481, -24.9884, -24.9301, -24.8902, -24.8466, -24.8282, -24.7644, -24.7635, -24.7384, -24.7165, -24.6769, -24.6685, -24.6456, -24.4973, -24.3115, -24.3044, -24.2837, -24.2143, -24.1525, -24.1459, -24.0299, -23.9117, -23.8602, -23.8567, -23.7702, -23.6109, -23.6044, -23.5902, -23.2556, -23.2269, -23.1487, -23.1416, -23.1275, -23.12, -23.0762, -23.0535, -22.9107, -22.9046, -22.8328, -22.7763, -22.6622, -22.6539, -22.6091, -22.6086, -22.596, -22.4267, -22.3958, -22.3689, -22.3484, -22.3348, -22.2618, -22.2558, -22.2556, -22.1596, -22.1583, -21.9357, -21.8401, -21.7899, -21.6683, -21.5879, -21.5776, -21.4543, -21.4426, -21.4268, -21.3259, -21.2901, -21.2727, -21.2241, -21.1784, -21.0968, -21.0701, -21.0221, -20.9209, -20.9177, -20.8652, -20.8105, -20.7013, -20.6833, -20.6668, -20.5941, -20.5892, -20.5257, -20.452, -20.4409, -20.3875, -20.3566, -20.3454, -20.3296, -20.099, -20.0647, -20.0606, -20.0342, -20.0037, -19.9836, -19.7564, -19.7326, -19.7087, -19.6247, -19.5285, -19.5148, -19.4695, -19.3149, -19.2924, -19.2723, -19.2393, -19.1554, -19.1139, -19.1115, -19.067, -19.0282, -19.0147, -18.9359, -18.913, -18.8859, -18.8836, -18.8609, -18.7921, -18.7166, -18.5017, -18.4348, -18.3576, -18.3491, -18.3082, -18.1548, -18.0769, -18.0713, -18.059, -18.0449, -18.0136, -17.9451, -17.8782, -17.812, -17.7419, -17.7117, -17.6568, -17.6442, -17.5817, -17.5292, -17.4962, -17.4327, -17.3994, -17.3664, -17.3282, -17.3139, -17.2661, -17.2446, -17.1955, -17.1604, -17.0913, -17.0813, -16.9587, -16.9336, -16.7349, -16.713, -16.713, -16.6241, -16.4729, -16.436, -16.3787, -16.3432, -16.3413, -16.3136, -16.2672, -16.2137, -16.13, -16.1136, -16.1135, -16.0841, -15.9994, -15.9803, -15.9736, -15.9406, -15.8784, -15.8414, -15.8283, -15.7756, -15.7237, -15.7141, -15.5976, -15.5893, -15.4614, -15.3652, -15.3115, -15.2656, -15.2173, -15.2111, -15.1131, -15.0823, -15.0559, -14.994, -14.9802, -14.97, -14.9539, -14.8293, -14.8005, -14.7851, -14.6725, -14.6686, -14.6114, -14.5185, -14.5125, -14.4956, -14.4568, -14.4293, -14.3936, -14.3881, -14.3682, -14.1979, -14.1872, -14.1107, -14.0483, -13.9616, -13.9317, -13.8872, -13.8684, -13.8538, -13.8082, -13.8028, -13.7118, -13.618, -13.5675, -13.5412, -13.5391, -13.5374, -13.5156, -13.499, -13.4751, -13.313, -13.2392, -13.0626, -13.0163, -13.011, -12.9685, -12.8979, -12.8828, -12.8508, -12.8167, -12.8007, -12.6849, -12.5678, -12.5634, -12.5608, -12.5352, -12.5183, -12.5058, -12.4331, -12.3483, -12.2614, -12.2442, -12.2011, -12.1236, -12.1201, -12.0701, -11.931, -11.8882, -11.7558, -11.7503, -11.7179, -11.7131, -11.6829, -11.6707, -11.6346, -11.5702, -11.5424, -11.5289, -11.4682, -11.4381, -11.4042, -11.3944, -11.3739, -11.339, -11.2888, -11.2619, -11.2488, -11.2376, -11.194, -11.1867, -11.138, -11.1341, -11.1257, -11.0778, -11.0754, -11.0651, -11.0613, -11.0524, -11.0519, -11.0458, -11.0458, -11.0276, -10.979, -10.9634, -10.9541, -10.9538, -10.9521, -10.9475, -10.9471, -10.9454, -10.9234, -10.9151, -10.9147, -10.9144, -10.8684, -10.86, -10.8564, -10.8526, -10.8484, -10.8462, -10.8455, -10.8427, -10.8418, -10.8306, -10.8217, -10.8138, -10.8076, -10.774, -10.7709, -10.7609, -10.7538, -10.7411, -10.7232, -10.7192, -10.7104, -10.7047, -10.6946, -10.6813, -10.6615, -10.6526, -10.6479, -10.6432, -10.6416, -10.6261, -10.6136, -10.6113, -10.5966, -10.5788, -10.5706, -10.5442, -10.5291, -10.5242, -10.5222, -10.5126, -10.5113, -10.5109, -10.4933, -10.4884, -10.4883, -10.4855, -10.4825, -10.4762, -10.461, -10.46, -10.4591, -10.417, -10.4153, -10.3917, -10.3632, -10.3401, -10.34, -10.3385, -10.3368, -10.3273, -10.3232, -10.3132, -10.295, -10.2942, -10.2864, -10.2846, -10.2807, -10.2627, -10.2578, -10.2457, -10.2248, -10.2065, -10.2061, -10.2059, -10.1887, -10.1881, -10.1752, -10.1663, -10.1643, -10.1459, -10.1277, -10.1189, -10.1123, -10.1079, -10.1057, -10.098, -10.0953, -10.095, -10.0735, -10.0413, -10.0395, -10.0307, -10.0086, -10.0086, -9.98343, -9.98247, -9.98142, -9.95288, -9.94897, -9.94086, -9.91718, -9.91265, -9.90152, -9.86081, -9.86078, -9.85941, -9.85918, -9.84541, -9.84199, -9.83809, -9.83631, -9.82118, -9.81962, -9.79362, -9.78861, -9.77443, -9.74807, -9.73849, -9.70932, -9.69597, -9.68816, -9.68689, -9.68346, -9.68179, -9.67889, -9.67542, -9.6644, -9.66322, -9.65282, -9.64857, -9.64703, -9.62609, -9.60843, -9.60516, -9.57357, -9.56785, -9.55343, -9.54603, -9.52166, -9.51531, -9.47708, -9.4648, -9.45125, -9.42622, -9.41556, -9.39015, -9.38492, -9.38236, -9.37225, -9.36585, -9.3485, -9.33986, -9.33049, -9.32287, -9.29318, -9.2624, -9.25001, -9.24766, -9.23907, -9.2369, -9.23417, -9.22856, -9.18665, -9.17048, -9.14478, -9.13916, -9.11303, -9.07893, -9.07513, -9.07443, -9.07023, -9.06025, -9.05466, -9.03064, -9.03052, -9.00833, -8.98746, -8.98446, -8.96773, -8.95686, -8.94079, -8.93838, -8.9352, -8.93302, -8.93279, -8.92108, -8.87552, -8.85626, -8.82042, -8.80996, -8.79011, -8.78222, -8.765, -8.7591, -8.74392, -8.73606, -8.73016, -8.70572, -8.69865, -8.69845, -8.69216, -8.68119, -8.66671, -8.66571, -8.66406, -8.6544, -8.65379, -8.65152, -8.64474, -8.64401, -8.62196, -8.62188, -8.60839, -8.60367, -8.58652, -8.54999, -8.52782, -8.51549, -8.51451, -8.51419, -8.51363, -8.49586, -8.48869, -8.4755, -8.46214, -8.42965, -8.42954, -8.41234, -8.40988, -8.39573, -8.38511, -8.35661, -8.31884, -8.3077, -8.29928, -8.21742, -8.18486, -8.17618, -8.15942, -8.13288, -8.12859, -8.11876, -8.1122, -8.09943, -8.08254, -8.07473, -8.07419, -8.06863, -8.04763, -8.03745, -8.03219, -7.96885, -7.96317, -7.91307, -7.90552, -7.90039, -7.88597, -7.88133, -7.88131, -7.87378, -7.8576, -7.85341, -7.85334, -7.84515, -7.81999, -7.8176, -7.75535, -7.71517, -7.71255, -7.6977, -7.69066, -7.68853, -7.67683, -7.66894, -7.65119, -7.63895, -7.60744, -7.57948, -7.55942, -7.54479, -7.54334, -7.53781, -7.53576, -7.52112, -7.51686, -7.51519, -7.49207, -7.48976, -7.46992, -7.46798, -7.44003, -7.39795, -7.39658, -7.37073, -7.34845, -7.3446, -7.32162, -7.32144, -7.28632, -7.27596, -7.26157, -7.25127, -7.25095, -7.22492, -7.21857, -7.18561, -7.16752, -7.16745, -7.15002, -7.10087, -7.0968, -7.09318, -7.0908, -7.09021, -7.07124, -7.06852, -7.0647, -7.05874, -7.0485, -7.02611, -7.01938, -7.01868, -6.99276, -6.96934, -6.9358, -6.92428, -6.90599, -6.90556, -6.89193, -6.88945, -6.86358, -6.82247, -6.81377, -6.80761, -6.80677, -6.79878, -6.75471, -6.75342, -6.74408, -6.72445, -6.70702, -6.70354, -6.69991, -6.68109, -6.6801, -6.63978, -6.59261, -6.57813, -6.56454, -6.54841, -6.54374, -6.52969, -6.5148, -6.51061, -6.48418, -6.47856, -6.47802, -6.46325, -6.43833, -6.42396, -6.40187, -6.36872, -6.36704, -6.33835, -6.32234, -6.31424, -6.31084, -6.30493, -6.28802, -6.25448, -6.24348, -6.23828, -6.17928, -6.1325, -6.1082, -6.07815, -6.05702, -6.04852, -6.0326, -6.02239, -6.00154, -5.97718, -5.95368, -5.95362, -5.95291, -5.93453, -5.91853, -5.90775, -5.90582, -5.86057, -5.85699, -5.85505, -5.84506, -5.8356, -5.83059, -5.82484, -5.82061, -5.76146, -5.74487, -5.74247, -5.73664, -5.7356, -5.72569, -5.71436, -5.70848, -5.70363, -5.69065, -5.66575, -5.62504, -5.6147, -5.60354, -5.59868, -5.59569, -5.58825, -5.58705, -5.57705, -5.55753, -5.54338, -5.53372, -5.52037, -5.52031, -5.51001, -5.50878, -5.49659, -5.48535, -5.48531, -5.47491, -5.45555, -5.40522, -5.339, -5.33753, -5.33007, -5.32283, -5.31578, -5.27932, -5.27497, -5.27467, -5.24341, -5.23962, -5.21031, -5.20093, -5.19845, -5.17497, -5.1354, -5.1221, -5.07924, -5.06923, -5.05568, -5.05203, -5.04152, -5.0283, -4.97487, -4.97439, -4.91672, -4.91601, -4.91275, -4.91131, -4.90852, -4.90368, -4.89841, -4.85885, -4.83954, -4.83516, -4.82317, -4.78948, -4.76991, -4.68914, -4.67481, -4.6612, -4.65465, -4.62795, -4.62187, -4.6103, -4.60282, -4.6004, -4.5936, -4.59328, -4.55496, -4.54448, -4.53246, -4.52399, -4.51376, -4.51011, -4.44559, -4.44015, -4.39362, -4.39221, -4.39082, -4.37393, -4.36499, -4.36391, -4.30028, -4.27628, -4.26751, -4.26491, -4.23552, -4.20921, -4.20854, -4.20193, -4.19429, -4.1673, -4.1646, -4.16321, -4.15003, -4.14877, -4.1474, -4.09079, -4.08654, -4.07955, -4.07479, -4.07359, -4.0706, -4.06059, -4.05784, -4.05649, -4.02457, -4.02327, -3.99905, -3.98697, -3.98632, -3.97139, -3.93339, -3.9317, -3.91575, -3.91212, -3.90691, -3.88898, -3.88083, -3.86195, -3.81765, -3.79722, -3.7908, -3.76902, -3.75638, -3.697, -3.67247, -3.6678, -3.63254, -3.62752, -3.52171, -3.50403, -3.49394, -3.48637, -3.48436, -3.47941, -3.47002, -3.43581, -3.40191, -3.39572, -3.36406, -3.35126, -3.33706, -3.32374, -3.30851, -3.29528, -3.2825, -3.28063, -3.25574, -3.25458, -3.24924, -3.16189, -3.15531, -3.14056, -3.13227, -3.13117, -3.12335, -3.10766, -3.06966, -3.03949, -3.03704, -3.01973, -3.01928, -3.01327, -3.01223, -3.00688, -3.00293, -2.99687, -2.98898, -2.97123, -2.96314, -2.91238, -2.87423, -2.85787, -2.85276, -2.83039, -2.81049, -2.80468, -2.80244, -2.79671, -2.79641, -2.78046, -2.76208, -2.73878, -2.71818, -2.7169, -2.70412, -2.68432, -2.68012, -2.64405, -2.62664, -2.62434, -2.61419, -2.61404, -2.61388, -2.60529, -2.58932, -2.58821, -2.57257, -2.56291, -2.54643, -2.53242, -2.52961, -2.52378, -2.50874, -2.50575, -2.47768, -2.47357, -2.46472, -2.454, -2.44438, -2.44269, -2.43538, -2.43331, -2.42244, -2.40742, -2.38726, -2.35362, -2.3378, -2.3327, -2.30257, -2.24954, -2.22348, -2.21957, -2.19918, -2.19846, -2.19547, -2.19438, -2.11975, -2.1156, -2.08397, -2.0831, -2.0814, -2.06721, -2.06, -2.04944, -2.03092, -2.02308, -2.02212, -2.01272, -2.0119, -1.99017, -1.98616, -1.96118, -1.9542, -1.9224, -1.91929, -1.9084, -1.82286, -1.81611, -1.81217, -1.78773, -1.7737, -1.77007, -1.77004, -1.74177, -1.73706, -1.73067, -1.72093, -1.71238, -1.66704, -1.62758, -1.55488, -1.54403, -1.53007, -1.52594, -1.50272, -1.49101, -1.48165, -1.45573, -1.45517, -1.45375, -1.42414, -1.42051, -1.41867, -1.41799, -1.38927, -1.38482, -1.376, -1.35403, -1.35156, -1.33173, -1.28715, -1.27978, -1.27213, -1.24995, -1.23985, -1.23016, -1.22488, -1.22085, -1.16073, -1.15805, -1.11825, -1.08273, -1.08174, -1.07781, -1.0593, -1.04757, -1.04647, -1.04104, -1.03847, -1.02273, -1.01624, -1.01391, -1.01086, -1.00663, -1.00573, -1.00091, -0.984439, -0.983988, -0.961864, -0.955577, -0.946805, -0.923394, -0.9123, -0.901655, -0.898033, -0.886857, -0.88272, -0.875559, -0.873278, -0.864358, -0.862751, -0.857067, -0.844177, -0.81639, -0.815598, -0.805905, -0.777727, -0.731292, -0.722864, -0.701254, -0.683745, -0.659512, -0.640403, -0.628149, -0.600515, -0.590624, -0.577284, -0.576326, -0.567448, -0.561445, -0.533714, -0.503598, -0.487869, -0.481881, -0.44152, -0.437092, -0.430303, -0.33299, -0.330787, -0.281799, -0.267038, -0.258819, -0.256795, -0.244508, -0.239257, -0.224984, -0.200997, -0.17173, -0.143733, -0.140255, -0.136769, -0.127383, -0.1079, -0.105269, -0.0964167, -0.0698237, -0.0697626, -0.0665202, -0.0659624, -0.0361616, -0.021446, -0.0212206, 0.0888497, 0.0951923, 0.102385, 0.117029, 0.118334, 0.124635, 0.129737, 0.130831, 0.148078, 0.151574, 0.152668, 0.199137, 0.208051, 0.24561, 0.256553, 0.262766, 0.26501, 0.268848, 0.285417, 0.310697, 0.316615, 0.335498, 0.359778, 0.383016, 0.389381, 0.39901, 0.457862, 0.470845, 0.472237, 0.474127, 0.475604, 0.485006, 0.533355, 0.543784, 0.55363, 0.579227, 0.583079, 0.588903, 0.620772, 0.666349, 0.672175, 0.681397, 0.681795, 0.69858, 0.70522, 0.743702, 0.750221, 0.776043, 0.780328, 0.780353, 0.786701, 0.804003, 0.806388, 0.82465, 0.866315, 0.87032, 0.893756, 0.895243, 0.897682, 0.925676, 0.943224, 0.947673, 0.961803, 0.963393, 0.965301, 0.965706, 0.988126, 1.0029, 1.01044, 1.01511, 1.03618, 1.06385, 1.06654, 1.07895, 1.1104, 1.1129, 1.11692, 1.1417, 1.15209, 1.16445, 1.16833, 1.21822, 1.25847, 1.27737, 1.27804, 1.30431, 1.30457, 1.33261, 1.33432, 1.35052, 1.35252, 1.35408, 1.36027, 1.3804, 1.40367, 1.44809, 1.46521, 1.48358, 1.49049, 1.50241, 1.52912, 1.53468, 1.55551, 1.56331, 1.57514, 1.59439, 1.61153, 1.6207, 1.63317, 1.65999, 1.6633, 1.67934, 1.72286, 1.741, 1.76596, 1.76687, 1.79066, 1.80517, 1.80783, 1.84473, 1.84938, 1.86984, 1.88807, 1.91178, 1.91526, 1.95013, 1.96142, 1.99161, 2.00825, 2.0099, 2.01211, 2.01813, 2.04724, 2.10586, 2.11099, 2.11212, 2.13694, 2.16107, 2.17265, 2.18648, 2.21484, 2.24522, 2.2569, 2.26427, 2.26832, 2.27404, 2.28165, 2.30964, 2.31588, 2.32193, 2.3264, 2.35961, 2.36803, 2.3924, 2.40712, 2.44028, 2.44332, 2.44843, 2.45133, 2.46369, 2.46555, 2.47365, 2.48321, 2.49442, 2.50293, 2.51871, 2.53362, 2.57365, 2.57368, 2.60559, 2.61239, 2.6132, 2.61521, 2.62017, 2.62935, 2.62988, 2.63282, 2.63341, 2.64068, 2.67838, 2.69196, 2.71102, 2.71245, 2.71414, 2.73465, 2.73906, 2.74913, 2.75467, 2.76126, 2.7614, 2.79011, 2.7974, 2.82865, 2.83107, 2.83761, 2.84004, 2.84595, 2.86016, 2.87238, 2.87919, 2.88016, 2.88236, 2.90624, 2.91825, 2.94075, 2.94478, 2.95832, 2.97281, 3.01844, 3.08365, 3.10052, 3.10527, 3.19473, 3.21503, 3.23383, 3.25405, 3.25987, 3.26189, 3.27398, 3.29034, 3.31905, 3.32581, 3.32738, 3.33126, 3.33267, 3.3356, 3.34577, 3.36375, 3.37367, 3.37674, 3.38558, 3.38882, 3.39212, 3.3979, 3.40207, 3.41892, 3.42005, 3.42234, 3.43462, 3.44028, 3.46181, 3.46563, 3.48315, 3.49076, 3.50556, 3.53531, 3.5404, 3.55795, 3.60361, 3.62174, 3.62568, 3.65842, 3.67298, 3.68645, 3.73944, 3.77261, 3.81155, 3.8117, 3.82578, 3.84287, 3.84615, 3.84969, 3.87501, 3.87521, 3.87934, 3.88191, 3.88557, 3.90144, 3.92676, 3.93072, 3.94906, 3.96761, 3.97262, 3.9797, 4.01785, 4.02514, 4.03953, 4.04414, 4.0776, 4.08036, 4.09267, 4.09647, 4.11304, 4.15882, 4.16279, 4.19115, 4.22097, 4.2308, 4.24059, 4.24305, 4.29717, 4.30397, 4.31743, 4.36453, 4.36683, 4.37257, 4.38147, 4.38245, 4.40816, 4.41113, 4.41991, 4.44139, 4.45099, 4.46307, 4.49256, 4.50442, 4.53707, 4.55663, 4.58308, 4.59104, 4.59275, 4.60327, 4.616, 4.61851, 4.62399, 4.62913, 4.63, 4.69105, 4.69156, 4.69775, 4.70292, 4.71075, 4.74062, 4.74674, 4.77985, 4.78536, 4.81303, 4.83791, 4.86691, 4.87262, 4.88571, 4.89149, 4.89901, 4.92612, 4.93761, 4.97096, 4.98051, 4.98362, 4.99413, 5.0199, 5.05383, 5.06333, 5.07678, 5.09606, 5.09609, 5.10798, 5.16585, 5.2066, 5.21135, 5.24757, 5.24772, 5.25233, 5.26423, 5.27513, 5.28704, 5.28861, 5.30769, 5.32126, 5.35119, 5.35558, 5.35708, 5.36838, 5.37561, 5.38537, 5.413, 5.44679, 5.47621, 5.49182, 5.52347, 5.52631, 5.54505, 5.55322, 5.56936, 5.59951, 5.64101, 5.6434, 5.66189, 5.6681, 5.74226, 5.75964, 5.79018, 5.79252, 5.81747, 5.82334, 5.87231, 5.91956, 5.92955, 5.93125, 5.93344, 5.95459, 5.98749, 5.99573, 6.00065, 6.01986, 6.05402, 6.05637, 6.10094, 6.12257, 6.12563, 6.13195, 6.14859, 6.15393, 6.1593, 6.19314, 6.1999, 6.25627, 6.26774, 6.2978, 6.31332, 6.32819, 6.33107, 6.33594, 6.3424, 6.35041, 6.3721, 6.3972, 6.41011, 6.41711, 6.44915, 6.4745, 6.51455, 6.52378, 6.55995, 6.57566, 6.57969, 6.58679, 6.58886, 6.59103, 6.62439, 6.67963, 6.6825, 6.70222, 6.71975, 6.72647, 6.74861, 6.76269, 6.77551, 6.78732, 6.83352, 6.85215, 6.86396, 6.87388, 6.88229, 6.89309, 6.89392, 6.89408, 6.91669, 6.93546, 7.01865, 7.02416, 7.02888, 7.03688, 7.06202, 7.06819, 7.07792, 7.09254, 7.10261, 7.10601, 7.11005, 7.12823, 7.13323, 7.191, 7.22476, 7.23836, 7.2448, 7.24678, 7.26009, 7.2622, 7.28281, 7.31261, 7.31563, 7.33584, 7.40805, 7.40891, 7.41388, 7.41451, 7.41694, 7.42975, 7.43145, 7.52352, 7.53474, 7.56095, 7.57683, 7.5894, 7.59784, 7.63157, 7.67819, 7.72486, 7.73124, 7.75558, 7.75758, 7.76871, 7.77427, 7.79905, 7.82807, 7.83072, 7.84141, 7.85482, 7.87092, 7.88438, 7.88802, 7.90337, 7.90595, 7.9436, 7.95635, 7.97189, 8.00695, 8.01201, 8.01377, 8.04482, 8.08698, 8.13702, 8.16908, 8.17205, 8.18522, 8.19265, 8.19873, 8.22413, 8.27635, 8.2832, 8.29559, 8.31617, 8.33016, 8.33929, 8.34449, 8.3451, 8.35265, 8.4524, 8.47307, 8.48421, 8.49497, 8.50095, 8.50234, 8.60291, 8.63666, 8.64309, 8.65423, 8.67927, 8.68606, 8.68855, 8.69314, 8.70234, 8.70264, 8.70268, 8.70862, 8.70964, 8.72083, 8.72391, 8.72579, 8.75361, 8.76938, 8.77305, 8.8071, 8.80975, 8.8282, 8.83535, 8.85113, 8.85777, 8.85938, 8.87377, 8.90504, 8.9192, 8.93863, 8.98096, 8.98125, 8.99448, 9.02559, 9.23841, 9.24502, 9.30913, 9.31151, 9.32161, 9.32554, 9.3381, 9.35283, 9.36852, 9.41025, 9.41639, 9.43198, 9.43217, 9.44135, 9.4419, 9.45379, 9.45635, 9.47081, 9.48171, 9.49984, 9.50818, 9.55343, 9.56561, 9.57653, 9.65082, 9.65202, 9.66561, 9.68281, 9.70323, 9.73285, 9.77968, 9.78778, 9.79166, 9.80581, 9.81276, 9.83065, 9.83721, 9.84738, 9.89416, 9.92612, 9.9562, 9.95934, 10.0009, 10.029, 10.041, 10.0417, 10.0502, 10.0566, 10.0585, 10.0719, 10.1029, 10.1144, 10.1358, 10.1649, 10.2098, 10.2289, 10.2753, 10.2789, 10.2876, 10.2887, 10.2969, 10.3051, 10.3121, 10.3429, 10.3527, 10.4039, 10.4097, 10.4355, 10.4618, 10.4671, 10.4784, 10.488, 10.561, 10.5789, 10.617, 10.6224, 10.6284, 10.6349, 10.6814, 10.6888, 10.6893, 10.6958, 10.7031, 10.7043, 10.7619, 10.8102, 10.8153, 10.8194, 10.8521, 10.8703, 10.9081, 10.9229, 10.9768, 11.0281, 11.1304, 11.161, 11.1655, 11.1798, 11.2042, 11.2193, 11.2791, 11.2907, 11.3201, 11.3453, 11.355, 11.3606, 11.3786, 11.4402, 11.4567, 11.5048, 11.5052, 11.5111, 11.529, 11.5507, 11.5707, 11.5918, 11.6111, 11.6396, 11.649, 11.6969, 11.7195, 11.7438, 11.7476, 11.748, 11.7655, 11.7675, 11.7708, 11.8026, 11.8119, 11.82, 11.8521, 11.8529, 11.8765, 11.931, 11.9339, 11.9959, 12.0131, 12.0319, 12.042, 12.0769, 12.1032, 12.1276, 12.1581, 12.1653, 12.2053, 12.2258, 12.2335, 12.3289, 12.3569, 12.3857, 12.4154, 12.4396, 12.4551, 12.4616, 12.4889, 12.5232, 12.5549, 12.5723, 12.5754, 12.6106, 12.6159, 12.7366, 12.7417, 12.7568, 12.7595, 12.7765, 12.7806, 12.791, 12.7949, 12.802, 12.8769, 12.8891, 12.9761, 13.0191, 13.0294, 13.0384, 13.045, 13.0531, 13.0635, 13.0737, 13.1105, 13.1566, 13.1972, 13.2282, 13.247, 13.2503, 13.2551, 13.281, 13.2852, 13.3039, 13.3405, 13.3449, 13.478, 13.4791, 13.4932, 13.4957, 13.5034, 13.5177, 13.5412, 13.6136, 13.6192, 13.6325, 13.6443, 13.6515, 13.6579, 13.6698, 13.6932, 13.7148, 13.7239, 13.7594, 13.7913, 13.8063, 13.9136, 13.9281, 13.9594, 13.9692, 13.9942, 13.9959, 14.0188, 14.0394, 14.0587, 14.0781, 14.0867, 14.1801, 14.1982, 14.2148, 14.2481, 14.2513, 14.259, 14.3038, 14.3077, 14.3534, 14.386, 14.3972, 14.4119, 14.4664, 14.4832, 14.5101, 14.5162, 14.5546, 14.5917, 14.6433, 14.6677, 14.6753, 14.6931, 14.7117, 14.7127, 14.7221, 14.7262, 14.7495, 14.752, 14.7601, 14.7824, 14.7907, 14.8078, 14.8288, 14.8554, 14.902, 14.9096, 15.0024, 15.0421, 15.0765, 15.1638, 15.1778, 15.2026, 15.2111, 15.2121, 15.2147, 15.2182, 15.2245, 15.26, 15.2772, 15.2782, 15.3159, 15.3191, 15.3864, 15.4292, 15.4491, 15.4713, 15.5027, 15.5112, 15.528, 15.5449, 15.5502, 15.5505, 15.5613, 15.5994, 15.6063, 15.6346, 15.6475, 15.682, 15.6831, 15.7345, 15.7533, 15.7678, 15.8217, 15.8361, 15.8412, 15.8476, 15.852, 15.8781, 15.8976, 15.9052, 15.9316, 15.9612, 15.9921, 16.0238, 16.1042, 16.1644, 16.1717, 16.2013, 16.2056, 16.2062, 16.2158, 16.2509, 16.2519, 16.2574, 16.2929, 16.3028, 16.3397, 16.3529, 16.364, 16.3662, 16.3797, 16.3863, 16.4086, 16.415, 16.428, 16.4435, 16.4466, 16.4609, 16.478, 16.5147, 16.5216, 16.535, 16.5542, 16.5555, 16.5583, 16.5675, 16.6229, 16.6392, 16.6555, 16.7262, 16.7686, 16.7854, 16.7867, 16.7948, 16.7948, 16.8197, 16.8323, 16.8333, 16.8336, 16.8398, 16.8629, 16.9181, 16.9222, 16.9652, 16.9708, 16.9733, 16.978, 17, 17.0628, 17.0745, 17.0901, 17.0996, 17.1055, 17.1126, 17.1284, 17.1902, 17.1963, 17.2024, 17.2106, 17.2183, 17.2329, 17.2483, 17.2606, 17.2687, 17.2881, 17.2968, 17.2997, 17.3572, 17.403, 17.406, 17.4354, 17.4499, 17.4785, 17.5072, 17.5127, 17.5128, 17.5366, 17.5441, 17.5458, 17.613, 17.6216, 17.6348, 17.7073, 17.7775, 17.7928, 17.8064, 17.8096, 17.8357, 17.8495, 17.8531, 17.9132, 17.9384, 17.9408, 17.9425, 17.9471, 17.9507, 17.9804, 17.983, 17.9848, 17.9907, 18.0341, 18.0638, 18.0985, 18.1148, 18.1259, 18.1699, 18.1978, 18.2033, 18.2056, 18.2433, 18.262, 18.2914, 18.31, 18.3344, 18.3641, 18.3642, 18.3818, 18.3822, 18.4103, 18.413, 18.4219, 18.4312, 18.4995, 18.5165, 18.5315, 18.5343, 18.5817, 18.5947, 18.603, 18.6143, 18.6559, 18.679, 18.7322, 18.7404, 18.7609, 18.7779, 18.8284, 18.8325, 18.8382, 18.8563, 18.8768, 18.8899, 18.9199, 18.9362, 18.9444, 18.9475, 18.9857, 19.0163, 19.0292, 19.0451, 19.0544, 19.1014, 19.1157, 19.1369, 19.1545, 19.1561, 19.1581, 19.1584, 19.1844, 19.2064, 19.2361, 19.2447, 19.286, 19.3202, 19.3414, 19.3649, 19.3703, 19.3817, 19.394, 19.3952, 19.4162, 19.4282, 19.463, 19.4668, 19.4723, 19.4898, 19.507, 19.531, 19.5339, 19.5404, 19.6485, 19.6502, 19.6752, 19.7044, 19.7084, 19.7158, 19.7249, 19.7317, 19.7513, 19.7795, 19.7886, 19.8221, 19.856, 19.8589, 19.8811, 19.8889, 19.8994, 19.9013, 19.9515, 19.9697, 20.0104, 20.0321, 20.0797, 20.0822, 20.0873, 20.101, 20.1035, 20.1271, 20.2415, 20.2537, 20.2544, 20.2659, 20.2823, 20.313, 20.334, 20.3422, 20.3615, 20.3774, 20.3825, 20.39, 20.4085, 20.4097, 20.432, 20.5153, 20.5381, 20.5536, 20.5723, 20.5862, 20.6119, 20.6291, 20.6954, 20.7117, 20.7215, 20.7358, 20.7424, 20.83, 20.8407, 20.8747, 20.8993, 20.9033, 20.9092, 20.9332, 20.9424, 20.9507, 20.9841, 20.9931, 21.0031, 21.0048, 21.0107, 21.0122, 21.0278, 21.0375, 21.0417, 21.066, 21.0674, 21.0944, 21.0998, 21.1024, 21.1317, 21.1603, 21.1731, 21.2005, 21.2127, 21.2144, 21.2365, 21.2483, 21.2555, 21.2609, 21.2731, 21.2916, 21.3003, 21.3055, 21.3279, 21.3484, 21.3704, 21.3969, 21.3974, 21.3978, 21.4212, 21.4263, 21.431, 21.4657, 21.5125, 21.5208, 21.5584, 21.581, 21.5821, 21.5838, 21.6344, 21.6378, 21.6379, 21.645, 21.6628, 21.6875, 21.7323, 21.7934, 21.798, 21.8058, 21.8093, 21.8098, 21.8216, 21.8218, 21.8259, 21.8496, 21.8645, 21.8722, 21.8783, 21.9815, 21.9977, 22.0009, 22.004, 22.0296, 22.032, 22.0526, 22.0532, 22.0683, 22.0712, 22.0756, 22.0968, 22.0982, 22.1108, 22.1179, 22.1193, 22.132, 22.1467, 22.1687, 22.1692, 22.1921, 22.2334, 22.2611, 22.2851, 22.3309, 22.3455, 22.3865, 22.3956, 22.3976, 22.4003, 22.4071, 22.4328, 22.4356, 22.4377, 22.4585, 22.4635, 22.4763, 22.4771, 22.5012, 22.5041, 22.5338, 22.5933, 22.6032, 22.6066, 22.619, 22.6231, 22.6245, 22.6505, 22.6935, 22.7021, 22.7782, 22.794, 22.7966, 22.8058, 22.8458, 22.8704, 22.8872, 22.8992, 22.9103, 22.942, 22.9596, 22.9782, 22.9882, 22.9887, 23.0034, 23.0359, 23.047, 23.0567, 23.0653, 23.0886, 23.1193, 23.1341, 23.1764, 23.2405, 23.2424, 23.2488, 23.2621, 23.3255, 23.3279, 23.3351, 23.3359, 23.3669, 23.4142, 23.4488, 23.4536, 23.4539, 23.473, 23.4795, 23.5349, 23.5464, 23.5647, 23.5661, 23.6038, 23.6236, 23.6408, 23.6428, 23.651, 23.6676, 23.6712, 23.6829, 23.6923, 23.7054, 23.7237, 23.7717, 23.7899, 23.8098, 23.8403, 23.8507, 23.854, 23.8859, 23.8892, 23.9134, 23.9711, 24.0256, 24.0621, 24.0742, 24.1196, 24.1441, 24.1561, 24.1598, 24.1606, 24.1686, 24.1727, 24.1832, 24.2084, 24.2472, 24.2826, 24.3036, 24.3094, 24.3161, 24.3166, 24.3238, 24.3291, 24.3311, 24.3312, 24.3683, 24.3707, 24.3743, 24.4031, 24.4108, 24.413, 24.425, 24.4307, 24.4415, 24.5254, 24.5518, 24.5553, 24.5887, 24.592, 24.6015, 24.6185, 24.6211, 24.6213, 24.6433, 24.6496, 24.6595, 24.6623, 24.6724, 24.7007, 24.703, 24.7134, 24.7164, 24.7461, 24.7684, 24.7759, 24.7797, 24.7836, 24.8194, 24.8218, 24.8549, 24.8701, 24.8929, 24.8993, 24.9043, 24.9112, 24.9203, 24.939, 24.9834, 25.0235, 25.0275, 25.0319, 25.1009, 25.1261, 25.1586, 25.1633, 25.2177, 25.2257, 25.2604, 25.2612, 25.2632, 25.2843, 25.2942, 25.3101, 25.3167, 25.3515, 25.3705, 25.4036, 25.4038, 25.429, 25.4693, 25.4901, 25.5013, 25.5087, 25.5593, 25.5614, 25.5733, 25.5769, 25.5775, 25.578, 25.5898, 25.5909, 25.6259, 25.6338, 25.6445, 25.6778, 25.7131, 25.7231, 25.7306, 25.7718, 25.7763, 25.7988, 25.7991, 25.8197, 25.8856, 25.9415, 25.9582, 25.9823, 25.9836, 25.9897, 26.0158, 26.016, 26.0283, 26.0539, 26.0556, 26.07, 26.087, 26.1067, 26.1082, 26.1113, 26.1687, 26.1751, 26.2012, 26.2205, 26.2556, 26.2558, 26.2787, 26.2931, 26.3026, 26.3667, 26.4331, 26.4524, 26.4567, 26.4752, 26.4938, 26.5036, 26.5376, 26.5444, 26.5524, 26.5979, 26.6017, 26.6073, 26.6121, 26.6493, 26.6561, 26.6977, 26.7028, 26.7322, 26.7414, 26.768, 26.7686, 26.795, 26.8159, 26.8236, 26.8261, 26.8448, 26.8685, 26.8704, 26.8974, 26.8974, 26.9361, 26.941, 26.9453, 26.9494, 26.958, 26.9758, 26.9837, 27.0549, 27.0955, 27.0956, 27.0988, 27.1301, 27.1377, 27.1551, 27.1601, 27.1709, 27.1773, 27.2722, 27.2908, 27.3116, 27.3234, 27.3255, 27.3376, 27.3766, 27.3817, 27.3826, 27.4425, 27.478, 27.504, 27.564, 27.5743, 27.5801, 27.5837, 27.6073, 27.6184, 27.6208, 27.634, 27.6501, 27.6624, 27.6681, 27.7062, 27.7129, 27.7451, 27.8228, 27.8288, 27.8585, 27.8598, 27.8827, 27.9206, 27.9422, 27.9637, 27.9846, 27.9872, 28.0089, 28.0092, 28.0102, 28.0109, 28.0114, 28.0202, 28.021, 28.0541, 28.0793, 28.0877, 28.0937, 28.1256, 28.1299, 28.132, 28.1576, 28.2184, 28.2231, 28.2276, 28.2651, 28.2863, 28.3045, 28.3206, 28.3335, 28.3798, 28.4127, 28.422, 28.439, 28.4396, 28.4497, 28.4601, 28.4614, 28.5612, 28.5729, 28.5813, 28.6181, 28.6392, 28.6574, 28.6603, 28.6701, 28.6827, 28.7116, 28.7776, 28.7779, 28.8081, 28.8105, 28.8158, 28.819, 28.836, 28.8391, 28.8422, 28.8477, 28.8775, 28.8882, 28.9176, 28.9315, 28.9742, 28.9924, 28.9971, 29.0057, 29.0115, 29.0279, 29.0449, 29.053, 29.0638, 29.097, 29.1083, 29.1185, 29.1191, 29.1432, 29.1522, 29.1735, 29.1882, 29.2102, 29.2151, 29.239, 29.2749, 29.3155, 29.3571, 29.3643, 29.4897, 29.4953, 29.499, 29.5031, 29.5183, 29.5555, 29.5594, 29.5762, 29.5875, 29.5878, 29.5901, 29.6277, 29.6643, 29.6763, 29.7102, 29.7142, 29.7482, 29.7758, 29.7775, 29.7994, 29.8021, 29.8102, 29.8241, 29.8478, 29.8645, 29.8794, 29.8899, 29.8993, 29.9182, 29.9193, 29.9351, 29.9504, 29.9608, 30.0109, 30.026, 30.0298, 30.037, 30.0437, 30.1031, 30.1164, 30.1364, 30.1427, 30.1506, 30.1565, 30.1661, 30.1709, 30.1786, 30.1866, 30.2095, 30.2321, 30.2932, 30.2933, 30.3212, 30.3285, 30.353, 30.3674, 30.3764, 30.3825, 30.3901, 30.4094, 30.4213, 30.4379, 30.4818, 30.4902, 30.5036, 30.5342, 30.5447, 30.5508, 30.582, 30.6219, 30.6339, 30.6461, 30.7113, 30.7687, 30.8641, 30.8831, 30.8903, 30.9291, 30.9757, 30.9961, 31.0152, 31.029, 31.0768, 31.1491, 31.2461, 31.3335, 31.4291, 31.5222, 31.5659, 31.5973, 31.7276, 31.9422, 32.13, 32.26, 32.3155, 32.3284, 32.4104, 32.5837, 32.6409, 32.7271, 32.876, 32.9395, 33.12, 33.6542, 33.8852, 34.1721, 34.3833 };
    Vec<TF> xs{ -41.5844, -40.8308, -40.0772, -39.3236, -38.57, -37.8164, -37.0628, -36.3092, -35.5556, -34.802, -34.0483, -33.2947, -32.5411, -31.7875, -31.0339, -30.2803, -29.5267, -28.7731, -28.0195, -27.2659, -26.5123, -25.7587, -25.0051, -24.2515, -23.4979, -22.7443, -21.9907, -21.2371, -20.4835, -19.7298, -18.9762, -18.2226, -17.469, -16.7154, -15.9618, -15.2082, -14.4546, -13.701, -12.9474, -12.1938, -11.4402, -10.6866, -9.93298, -9.17937, -8.42577, -7.67216, -6.91855, -6.16495, -5.41134, -4.65774, -3.90413, -3.15053, -2.39692, -1.64332, -0.889712, -0.136107, 0.617499, 1.3711, 2.12471, 2.87831, 3.63192, 4.38553, 5.13913, 5.89274, 6.64634, 7.39995, 8.15355, 8.90716, 9.66076, 10.4144, 11.168, 11.9216, 12.6752, 13.4288, 14.1824, 14.936, 15.6896, 16.4432, 17.1968, 17.9504, 18.704, 19.4576, 20.2112, 20.9648, 21.7184, 22.4721, 23.2257, 23.9793, 24.7329, 25.4865, 26.2401, 26.9937, 27.7473, 28.5009, 29.2545, 30.0081, 30.7617, 31.5153, 32.2689, 33.0225, 33.7761 };
    Vec<TF> ys{ 73, 64, 108, 137, 149, 158, 165, 169, 179, 270, 338, 355, 427, 352, 374, 404, 360, 394, 382, 402, 403, 403, 412, 506, 471, 481, 470, 509, 514, 522, 527, 517, 513, 497, 495, 493, 490, 529, 538, 486, 1126, 2229, 2024, 2011, 2300, 2126, 2075, 1854, 1727, 1705, 1726, 1736, 1696, 1790, 1737, 1833, 2202, 1788, 1481, 1350, 1316, 1190, 1113, 1123, 1206, 1188, 1133, 1123, 1176, 1119, 896, 849, 855, 888, 955, 1014, 1053, 1132, 1257, 1436, 1720, 1490, 1550, 1577, 1485, 1759, 1900, 1625, 1437, 1395, 1415, 1408, 1330, 1480, 1390, 818, 767, 771, 750, 359 };
    auto de = RcPtr<PiecewiseAffineDensity<TF>>::New( xs, ys );

    // glot( -3, +6, 500, 
    //     [&]( TF x ) { return cb->value( x ); },
    //     [&]( TF x ) { return cb->integral( x, x + 1e-3 ) / 1e-3; }
    // );

    auto pd = RcPtr<PowerDiagram<TF>>::New( di, di );
    Solver<TF> sr( pd, de, 0.984 );
    sr.verbosity = 2;
    sr.solve();

    // on va jusqu'au bout
    // Vec<Vec<Vec<TF>>> bpe( FromSize(), 10 ); // barycentres avec poids extrapolés
    // Vec<Vec<Vec<TF>>> wse( FromSize(), 10 ); // poids extrapolés
    // Vec<Vec<FP64>> bp;
    // Vec<Vec<TF>> ws;
    // auto interp_width_1 = [&]( TF w1, TF nd = 100 ) {
    //     for( PI d = 0; d <= nd; ++d ) {
    //         const TF width = wo + ( w1 - wo ) * pow( d / nd, 1 );
    //         c0->int_conv.width = width;

    //         P( width );
    //         pd.update_weights();
    
    //         bp << pd.barycenters_ap( 1000 );
    //         ws << pd.sorted_seed_weights;

    //         // on sort une version extrapolée
    //         // for( PI o = 2; o <= 5; ++o ) {
    //         //     pd.sorted_seed_weights = extrapolation( wsi, ( intermediate_width - width ) / epsilon, o + 1 );
    //         //     bpe[ o ] << pd.barycenters_ap( 10000 );
    //         //     wse[ o ] << pd.sorted_seed_weights;
    //         //     pd.sorted_seed_weights = ws.back();
    //         // }
    //     }
    //     wo = w1;
    // };
    // // for( TF x = 0.5; x > 1e-4; x *= 0.9 )        
    // interp_width_1( 1e-3, 20000 );

    // glot_barycenters( bp, bpe );
}

